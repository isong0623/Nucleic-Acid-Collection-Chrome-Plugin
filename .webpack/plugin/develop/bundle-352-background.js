(()=>{class e{static v1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";static v2=[];static fq(t){let n,s,o,r="";for(let i=0,a=t.length;i+2<a;i+=3)n=t[i],s=t[i+1],o=t[i+2],r+=e.v1[n>>2],r+=e.v1[63&(n<<4|s>>4)],r+=e.v1[63&(s<<2|o>>6)],r+=e.v1[63&o];switch(t.length%3){case 1:n=t[t.length-1],r+=e.v1[(252&n)>>2],r+=e.v1[(3&n)<<4],r+="==";break;case 2:n=t[t.length-2],s=t[t.length-1],r+=e.v1[(252&n)>>2],r+=e.v1[(3&n)<<4|(240&s)>>4],r+=e.v1[(15&s)<<2],r+="=";break}return r}static fr(t){const n=[];for(let s,o=0,r=t.length;o<r&&(s=e.v2[t.charCodeAt(o++)]<<18,s+=e.v2[t.charCodeAt(o++)]<<12,n.push((16711680&s)>>16),!(o>=r||t.charCodeAt(o)===e.v1.charCodeAt(64)))&&(s+=e.v2[t.charCodeAt(o++)]<<6,n.push((65280&s)>>8),!(o>=r||t.charCodeAt(o)===e.v1.charCodeAt(64)));)s+=e.v2[t.charCodeAt(o++)],n.push(255&s);return n}static fw(t){if(null==t)return"";const n=e.fs(t);return e.fq(n)}static fx(t){const n=e.fr(t);return e.fu(n)}static fs(e){e=e.replace(/\r\n/g,"\n");const t=[];for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t.push(s):s>127&&s<2048?(t.push(s>>6|192),t.push(63&s|128)):(t.push(s>>12|224),t.push(s>>6&63|128),t.push(63&s|128))}return t}static ft=function(e){e=e.replace(/\r\n/g,"\n");let t="";for(let n=0;n<e.length;n++){let s=e.charCodeAt(n);s<128?t+=String.fromCharCode(s):s>127&&s<2048?(t+=String.fromCharCode(s>>6|192),t+=String.fromCharCode(63&s|128)):(t+=String.fromCharCode(s>>12|224),t+=String.fromCharCode(s>>6&63|128),t+=String.fromCharCode(63&s|128))}return t};static fu=function(e){let t="";let n=0;let s=0,o=0,r=0;for(;n<e.length;)s=e[n],s<128?(t+=String.fromCharCode(s),n++):s>191&&s<224?(o=e[n+1],t+=String.fromCharCode((31&s)<<6|63&o),n+=2):(o=e[n+1],r=e[n+2],t+=String.fromCharCode((15&s)<<12|(63&o)<<6|63&r),n+=3);return t};static fv=function(e){let t="";let n=0;let s=0,o=0,r=0;for(;n<e.length;)s=e.charCodeAt(n),s<128?(t+=String.fromCharCode(s),n++):s>191&&s<224?(o=e.charCodeAt(n+1),t+=String.fromCharCode((31&s)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),r=e.charCodeAt(n+2),t+=String.fromCharCode((15&s)<<12|(63&o)<<6|63&r),n+=3);return t}}for(let t=0,n=64;t<n;++t)e.v2[e.v1.charCodeAt(t)]=t;function t(e){return String.fromCharCode(e)}JSON.parseBody=function(e){let n={};if(null==e)return n;if(e.constructor===String){if(e.trim().startsWith("{"))try{n=JSON.parse(e)}catch(e){}if(0===Object.keys(n).length&&0!==(e?.length??0)&&!0===e.trim().startsWith("http")){const s=e.indexOf("?");if(s>-1){const o=function(e){let n="";for(let o=0;o<e.length;o+=1){let r=e.charAt(o);if("+"===r)n+=" ";else if("%"===r){var s=e.substring(o+1,o+3);parseInt("0x"+s)>127?(n+=decodeURI("%"+s.toString()+e.substring(o+3,o+9).toString()),o+=8):(n+=t(parseInt("0x"+s)),o+=2)}else n+=r}return n}(e.substring(s+1));o.split("&").map((e=>{let t=e.indexOf("=");if(t<0)return;let s=e.substring(0,t);let o=e.substring(t+1);n[s]=o}))}}0===Object.keys(n).length&&0!==(e?.length??0)&&e.split(",").map((e=>{let t=e.indexOf("=");if(t<0)return;let s=e.substring(0,t);let o=e.substring(t+1);n[s]=o}))}else try{n=JSON.parse(JSON.stringify(e))}catch(e){}return n};class n{static sleep(e){return new Promise((t=>setTimeout(t,e)))}static isNull(e){return null==e}}Date.prototype.Format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e};class s{static log(e,t="",n=!0){try{if(null==e)return;if(e.constructor===String)null!=t&&t?.length>0?console.log(t+"->"+e):console.log(e);else if(n)console.log(e);else try{const n=JSON.stringify(e);if(n.length>0)null!=t&&t?.length>0?console.log(t+"->"+n):console.log(n);else{let t=e?.toString();console.log(t.length>0?t:e)}}catch(t){console.log(e)}}catch(e){}}static warn(e,t="",n=!0){try{if(null==e)return;if(e.constructor===String)null!=t&&t?.length>0?console.warn(t+"->"+e):console.warn(e);else if(n)console.warn(e);else try{const n=JSON.stringify(e);n.length>0?null!=t&&t?.length>0?console.warn(t+"->"+n):console.warn(n):console.warn(e)}catch(t){console.warn(e)}}catch(e){}}}class o{static speak(e,t=!0,n,s){const o=e?.toString()??"";if(0===(o?.length??0))return;if(1)try{chrome?.tts?.speak(o,{enqueue:!0===t,rate:n,pitch:s})}catch(e){}}}class r{static f3H(e){try{chrome?.runtime?.sendMessage(e)}catch(e){}}static f3I=r.f3H;static f3J=r.f3H;static f3K=r.f3H;static f3L=r.f3H;static f3M(e){if(null!==r.f3P.vM&&void 0!==r.f3P.vM)try{chrome?.tabs?.sendMessage(r.f3P.vM.tabId,e)}catch(e){}}static f3N(e){r.f3K({type:"m4",msg:e})}static f3O(e){r.f3L({type:"m4",msg:e})}}r.f3P={speak:function(e,t,n,s){o.speak(e,t,n,s)},speakDelay:function(e,t=!0,n=0){setTimeout((()=>r.f3P.speak(e,t)),n)},speakInCommand:function(e,t){r.f3M({type:"speak",msg:{msg:e,enqueue:t}})},f2u:function(){r.f3M({type:"f2u"})},vM:null},r.f3Q={speak:function(e,t=!0,n,s){r.f3H({type:!0===t?"speak":"speak2",msg:e,rate:n,pitch:s})},f2N:()=>{r.f3H({type:"f2N"})},f2M:()=>{r.f3H({type:"f2M"})},f2L:()=>{r.f3H({type:"f2L"})},f3X:()=>{r.f3J({type:"onDeviceInit",data:e.fw(JSON.stringify(i.getOfflineDevice()))})}},r.f3R={speak:r.f3P.speak,onSettingChanged:()=>{const e=i.toJSON();const t={type:"onSettingChanged",settings:e};r.f3N(t),r.f3K(t)},m5:()=>{r.f3N({type:"m5"})},m6:()=>{r.f3N({type:"onDeviceInit",data:e.fw(JSON.stringify(i.getOfflineDevice()))})}},r.f3S={};class i{static save_options(){i.f2v(i.v3,i.vx),i.f2v(i.v4,i.vy),i.f2v(i.v5,i.vz),i.f2v(i.v6,i.vA),i.f2v(i.v7,i.vB),i.f2v(i.v8,i.vC),i.f2v(i.v9,i.vD),i.f2v(i.va,i.vE),i.f2v(i.vb,i.vF),i.f2v(i.vc,JSON.stringify(i.vG)),i.f2v(i.vd,i.vH),i.f2v(i.ve,i.vI),i.f2v(i.vf,i.vJ),i.f2v(i.vg,i.vK),i.f2v(i.vh,i.vL),i.f2v(i.keyOfBarcodeCapacity,i.configOfBarcodeCapacity),i.f2v(i.keyOfBarcodeCommitNum,i.configOfBarcodeCommitNum)}static restore_options(){i.vx=i.f2w(i.v3,i.vi),i.vy=i.f2w(i.v4,i.vj),i.vz=i.f2w(i.v5,i.vk),i.vA=i.f2w(i.v6,i.vl),i.vB=i.f2w(i.v7,i.vm),i.vC=i.f2w(i.v8,i.vn),i.vD=i.f2w(i.v9,i.vo),i.vE=i.f2w(i.va,i.vp),i.vF=i.f2w(i.vb,i.vq),i.vH=i.f2w(i.vd,i.vs),i.vI=i.f2w(i.ve,i.vt),i.vJ=i.f2w(i.vf,i.vu),i.vK=i.f2w(i.vg,i.vv),i.vL=i.f2w(i.vh,i.vw),i.vG=i.f2w(i.vc,i.vr),i.configOfBarcodeCapacity=i.f2w(i.keyOfBarcodeCapacity,i.defaultOfBarcodeCapacity),i.configOfBarcodeCommitNum=i.f2w(i.keyOfBarcodeCommitNum,i.defaultOfBarcodeCommitNum);try{i.vG=JSON.parse(i.vG)}catch(e){try{i.vG=JSON.parse(i.vr)}catch(e){}}}static reset_options(){i.f2v(i.v3,i.vi),i.f2v(i.v4,i.vj),i.f2v(i.v5,i.vk),i.f2v(i.v6,i.vl),i.f2v(i.v7,i.vm),i.f2v(i.v8,i.vn),i.f2v(i.v9,i.vo),i.f2v(i.va,i.vp),i.f2v(i.vb,i.vq),i.f2v(i.vc,i.vr),i.f2v(i.vd,i.vs),i.f2v(i.ve,i.vt),i.f2v(i.vf,i.vu),i.f2v(i.vg,i.vv),i.f2v(i.vh,i.vw),i.f2v(i.keyOfBarcodeCapacity,i.defaultOfBarcodeCapacity),i.f2v(i.keyOfBarcodeCommitNum,i.defaultOfBarcodeCommitNum),i.restore_options()}static restoreFromJSON(t){i.vx=t.vx,i.vy=t.vy,i.vz=t.vz,i.vA=t.vA,i.vB=t.vB,i.vC=t.vC,i.vD=t.vD,i.vE=t.vE,i.vF=t.vF,i.vG=JSON.parse(e.fx(t.vG)),i.vH=t.vH,i.vI=t.vI,i.vJ=t.vJ,i.vK=t.vK,i.vL=t.vL,i.configOfBarcodeCapacity=t.configOfBarcodeCapacity,i.configOfBarcodeCommitNum=t.configOfBarcodeCommitNum,i.save_options()}static toJSON(){return{vx:i.vx,vy:i.vy,vz:i.vz,vA:i.vA,vB:i.vB,vC:i.vC,vD:i.vD,vE:i.vE,vF:i.vF,vG:e.fw(JSON.stringify(i.vG)),vH:i.vH,vI:i.vI,vJ:i.vJ,vK:i.vK,vL:i.vL,configOfBarcodeCapacity:i.configOfBarcodeCapacity,configOfBarcodeCommitNum:i.configOfBarcodeCommitNum}}static setOfflineDevice(e){try{localStorage._hscj_offline_device__=JSON.stringify(e)}catch(e){localStorage._hscj_offline_device__="{}"}}static getOfflineDevice(){const e=localStorage._hscj_offline_device__;if(0===(e?.trim()?.length??0))return{};try{return JSON.parse(e)}catch(e){return{}}}static _f1y=!1;static setOfflineMode(e){this._f1y=e}static f1y(){return this._f1y}static _isBreakLineMode=!1;static setBreakLineMode(e){this._isBreakLineMode=e}static isBreakLineMode(){return this._isBreakLineMode}static _breakLineLoginData={username:"",password:"",isLogin:!1,msg:"未登录"};static setBreakLineLoginData(e){this._breakLineLoginData=e}static getBreakLineLoginData(){return this._breakLineLoginData}static isBreakLineLogin(){return!0===this._breakLineLoginData?.isLogin}static f2h(e){localStorage._hscj_camera_visible__=e}static isCameraVisible(){const e=localStorage._hscj_camera_visible__;return null==e||(!0===e||"true"===e)}static getBarcodeCommitNum(){return this.configOfBarcodeCapacity}static async f3W(t){const n=t.type;if("onSettingChanged"===n){let e="";try{e=JSON.stringify(t.settings)}catch(e){}return i.restoreFromJSON(t.settings),!0}if("m5"===n)return r.f3Q.f3X(),!0;if("m6"===n){const n=t.data;let s={};try{s=JSON.parse(e.fx(n))}catch(e){}return i.setOfflineDevice(s),!0}return!1}}i.v3="__k_0_",i.v4="__k_1_",i.v5="__k_2_",i.v6="__k_3_",i.v7="__k_4_",i.v8="__k_5_",i.v9="__k_6_",i.va="__k_7_",i.vb="__k_8_",i.vc="__k_9_",i.vd="__k_A_",i.ve="__k_B_",i.vf="__k_C_",i.vg="__k_D_",i.vh="__k_E_",i.keyOfBarcodeCapacity="__k_F_",i.keyOfBarcodeCommitNum="__k_G_",i.vi=12,i.vj="",i.vk=!0,i.vl="",i.vm=3e3,i.vn=400,i.vo=250,i.vp=150,i.vq="[0-9A-Za-z:]*::$\n[a-zA-Z0-9]{0,5}#[a-zA-Z0-9+/]*={0,2}$",i.vr=JSON.stringify([{no:0,bind:"试管容量",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,0]},{no:1,bind:"试管编号",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,1]},{no:2,bind:"居民码",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,2]},{no:3,bind:"证件类型",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,3]},{no:4,bind:"证件号",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,4]},{no:5,bind:"证件读取按钮",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,5]},{no:6,bind:"姓名",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,6]},{no:7,bind:"手机号",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,7]},{no:8,bind:"街道(镇)",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,8]},{no:9,bind:"居委会(村)",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,9]},{no:10,bind:"所属小区",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,10]},{no:11,bind:"人员类别",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,11]},{no:12,bind:"采样单位",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,12]},{no:13,bind:"采样日期",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,13]},{no:14,bind:"已取样数",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,14]},{no:15,bind:"现住址",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,15]},{no:16,bind:"附加说明",type:"document.body.getElementsByClassName",id:"",class:"el-form",indexes:[0,16]},{no:17,bind:"确认采样",type:"document.body.getElementsByClassName",id:"",class:"el-button el-button--success el-button--medium",indexes:[0]},{no:18,bind:"重置采样",type:"document.body.getElementsByClassName",id:"",class:"el-button el-button--danger el-button--medium",indexes:[0]},{no:19,bind:"试管警告",type:"document.body.getElementsByClassName",id:"",class:"el-button el-button--default el-button--small el-button--primary",indexes:[0]},{no:20,bind:"试管更换",type:"document.body.getElementsByClassName",id:"",class:"van-button van-button--default van-button--large van-dialog__confirm",indexes:[0]},{no:21,bind:"证件号读取警告",type:"document.getElementsByClassName",id:"",class:"el-message el-message--warning",indexes:[]}]),i.vs=8,i.vt=!0,i.vu=!0,i.vv=!0,i.vw=!0,i.defaultOfBarcodeCapacity=20,i.defaultOfBarcodeCommitNum=0,i.f2w=function(e,t){if(null==e)return t;if(e.constructor!==String)return t;const n=localStorage[e];if(null==n)return t;if(null==t)return n;try{switch(t.constructor){case String:return n;case Number:return parseInt(n);case Boolean:let e=null;try{e=parseInt(n)}catch(e){}const t=!1===n||"false"===n;return!t&&("true"===n||!0===n||null!=e&&!isNaN(e)&&0!==e);case JSON:return JSON.parse(n)}}catch(e){}return n},i.f2v=function(e,t){if(n.isNull(t)){try{localStorage[e]=t}catch(e){}return}let s=null;try{switch(t.constructor){case Number:case String:case Boolean:s=t;break;case JSON:s=JSON.stringify(t);break;default:s=t.toString()}}catch(e){s=t}try{localStorage[e]=s}catch(e){}},i.choseCheckDisplay=function(e,t){!0===t||"true"===t?(document.getElementById(e).className="checked",document.getElementById(e).check=!0):(document.getElementById(e).className="uncheck",document.getElementById(e).check=!1)},i.restore_options(),i.setOfflineMode(!1);class a{static async f1(e,t,n){}static f3(e,t,n){}static f4(e,t,n){}static f5(e,t,n){}static f6(e,t,n){}static f7(e,t,n){}static f8(e,t,n){}static f9(e,t,n){}}a.tag="c1",a.Message={onApiIntercepted:{key:"onApiIntercepted",params:{method:"method",requestInfo:"requestInfo",requestId:"requestId"},methods:{f3:"f3",f4:"f4",f5:"f5",f6:"f6",f7:"f7",f8:"f8",f9:"f9"}},onApiInterceptCallback:{key:"onApiInterceptCallback",params:{requestId:"requestId",result:"result",data:"data"}}},a.debug=function(e){s.log(e,"Background.c1")},a.f1=async function(t,o,i){if(!o?.startsWith("F"))return!1;if("Fetch.requestPaused"!==o)return!0;try{i.requestInfo=JSON.parseBody(i.request?.postData??i.request.url)}catch(e){i.requestInfo={}}let c=!1;return await new Promise((async(e,t)=>{try{if(i.request.headers["HSCJ-Plugin-Offline-Mode"]?.toString()===(!0).toString())return void t();if(a.interceptMap[i.requestId]={resolve:t=>e(t),reject:e=>t(e)},i.request.url.indexOf("getTestedListByTubeNum")>-1)return await n.sleep(500),void await a.f3(e,t,i);if(i.request.url.indexOf("findPeopleListForInput")>-1)return void await a.f4(e,t,i);if(i.request.url.indexOf("decryptHealthQr")>-1)return void await a.f5(e,t,i);if(i.request.url.indexOf("confirmed")>-1)return void await a.f6(e,t,i);if(i.request.url.indexOf("findGridsByParentId")>-1)return void await a.f7(e,t,i);if("https://hsjc.qingdao.gov.cn/"===i.request.url)return await a.f9(e,t,i),setTimeout((()=>{c||e("等待离线采样页面加载完毕...")}),1e4),void setTimeout((()=>{c||r.f3M({type:"m2"})}),12e3);if(i.request.url.indexOf("findSiteDevice")>-1)return await n.sleep(3e3),void await a.f8(e,t,i);try{delete a.interceptMap[i.requestId]}catch(e){}t()}catch(e){s.warn(e)}finally{setTimeout((()=>t()),35e3)}})).then((async n=>{if(!c){c=!0;try{chrome.debugger.sendCommand(t,"Fetch.fulfillRequest",{requestId:i.requestId,responseCode:200,responseHeaders:[{name:"Content-Type",value:"application/json;charset=UTF-8"},{name:"HSCJ-Plugin-Cached",value:"true"}],body:e.fw(JSON.stringify(n))})}catch(e){a.debug(e)}}})).catch((async()=>{if(c)return;c=!0;const e=[];const n=JSON.parse(JSON.stringify(i.request.headers));Object.entries(n).forEach(((t,n,s)=>{"cookie"!==t[0].toString().toLowerCase().trim()&&e.push({name:t[0],value:t[1]})}));try{chrome.debugger.sendCommand(t,"Fetch.continueRequest",{requestId:i.requestId,headers:e})}catch(e){a.debug(e)}})),!0},a.f2=function(e){const t=e.type;if(t!==a.Message.onApiInterceptCallback.key)return!1;const o=e.requestId;const r=e.result;const i=e.data;const c=a.interceptMap[o];return n.isNull(c)||!0===c.process||(c.process=!0,new Promise((async(e,t)=>{if(!0===r)try{await c.resolve(i)}catch(e){s.warn(e)}else try{await c.reject(i)}catch(e){s.warn(e)}try{delete a.interceptMap[o]}catch(e){}e()})).then((()=>{})).catch((()=>{}))),!0},a.f3=async function(e,t,n){r.f3M({type:a.Message.onApiIntercepted.key,method:a.Message.onApiIntercepted.methods.f3,requestInfo:n.requestInfo,requestId:n.requestId})},a.f4=async function(e,t,n){r.f3M({type:a.Message.onApiIntercepted.key,method:a.Message.onApiIntercepted.methods.f4,requestInfo:n.requestInfo,requestId:n.requestId})},a.f5=async function(e,t,n){r.f3M({type:a.Message.onApiIntercepted.key,method:a.Message.onApiIntercepted.methods.f5,requestInfo:n.requestInfo,requestId:n.requestId})},a.f6=async function(e,t,n){r.f3M({type:a.Message.onApiIntercepted.key,method:a.Message.onApiIntercepted.methods.f6,requestInfo:n.requestInfo,requestId:n.requestId})},a.f7=async function(e,t,n){r.f3M({type:a.Message.onApiIntercepted.key,method:a.Message.onApiIntercepted.methods.f7,requestInfo:n.requestInfo,requestId:n.requestId})},a.f8=async function(e,t,n){r.f3M({type:a.Message.onApiIntercepted.key,method:a.Message.onApiIntercepted.methods.f8,requestInfo:n.requestInfo,requestId:n.requestId})},a.f9=async function(e,t,n){r.f3M({type:a.Message.onApiIntercepted.key,method:a.Message.onApiIntercepted.methods.f9,requestInfo:n.requestInfo,requestId:n.requestId})},a.interceptMap=new Map;class c{static async fg(e,t,n){}static fh=function(e,t){};static fi=function(e,t){};static fj=function(e,t){};static fk=function(e,t){};static fl=function(e,t){};static fm=function(e,t){};static fn=function(e,t){};static fo=function(e,t){};static fp=function(e,t){}}c.tag="c3",c.Message={onApiReceived:{key:"onApiReceived",params:{method:"method",requestInfo:"requestInfo",responseInfo:"responseInfo"},methods:{fh:"fh",fi:"fi",fj:"fj",fk:"fk",fl:"fl",fm:"fm",fn:"fn",fo:"fo",fp:"fp"}}},c.debug=function(e){s.log(e,"Background.c3")},c.requestIdMapper=new Map,c.reverseIdMapper=new Map,c.lastAutoDelTime=0,c.markPluginRequestInfo=function(e,t,s,o){const r=(new Date).getTime();c.requestIdMapper[e]=t,c.reverseIdMapper[t]={pluginRequestId:e,timestamp:r,url:s,offline:o};const i=c.lastAutoDelTime??0;r-i<3e4||(c.lastAutoDelTime=r,Object.keys(c.reverseIdMapper).forEach(((e,t,s)=>{const o=c.reverseIdMapper[e];n.isNull(o)||r-o.timestamp>6e4&&delete c.reverseIdMapper[e]})))},c.getPluginRequestId=function(e){return c.reverseIdMapper[e]?.pluginRequestId},c.getPluginRequestUrl=function(e){return c.reverseIdMapper[e]?.url},c.isRequestOffline=function(e){return!0===c.reverseIdMapper[e]?.offline},c.fg=async function(t,o,a){if(!o?.startsWith("N"))return!1;const f=a?.request?.url??a?.response?.url??c.getPluginRequestUrl(a.requestId)??"";const d=(a?.type??a?.initiator?.type)?.toLowerCase()?.trim()??"";if("xhr"!==d)return!0;const u=f.indexOf("localhost")>-1||f.indexOf("127.0.0.1")>-1||f.indexOf("0.0.0.0")>-1;const l=f.indexOf("hsjc.qingdao.gov.cn")>-1;if("Network.loadingFailed"===o){if(l&&!u&&(s.log(f+"\n"+JSON.stringify({params:a})),r.f3M({type:"fa",timestamp:(new Date).getTime(),interval:6e4}),f.indexOf("login")>0)){let e={};try{e=JSON.parseBody(p)}catch(e){}r.f3M({type:"m2",username:e.username,password:e.password})}return!0}if("Network.requestWillBeSent"===o){const e=a?.request?.headers["HSCJ-Plugin-Request-ID"];const t="true"===a?.request?.headers["HSCJ-Plugin-Offline-Mode"];return n.isNull(e)?!u&&l&&c.markPluginRequestInfo(a.requestId,a.requestId,f,t):c.markPluginRequestInfo(e,a.requestId,f,t),!0}if("Network.responseReceived"!==o)return!0;if(u)return!0;if(!l)return!0;c.isRequestOffline(a.requestId);const v="true"===a?.response?.headers["HSCJ-Plugin-Cached"];const m=!n.isNull(a?.response?.headers["HSCJ-Plugin-Ping-Request-Description"]);if(m)return!0;const p=f;const g=p.indexOf("login")>-1;const y=p.indexOf("getUserToken")>-1;const h=p.indexOf("getTestedListByTubeNum")>-1;const I=p.indexOf("findPeopleListForInput")>-1;const b=p.indexOf("findGridsByParentId")>-1;const w=p.indexOf("decryptHealthQr")>-1;const C=p.indexOf("confirmed")>-1;const q=p.indexOf("delTestResult")>-1;const M=p.indexOf("findTestResult")>-1;const k=p.indexOf("findSiteDevice")>-1;if(y&&(a?.response?.status??0)>=400)return r.f3M({type:"m1"}),!0;const _=h||w||C||b||I;_&&r.f3M({type:"autoAddComponent"});let O=!i.f1y()||!v;if(O){const e=a?.response?.timing?.requestTime??a?.response?.timing?.connectStart??0;const t=a?.timestamp??0;const n=1e3*(t-e);n>0&&r.f3M({type:"fa",timestamp:(new Date).getTime()-n,interval:n})}const N=g||h||I||b||w||C||q||M||k;if(!N)return!0;let S={};let B={};const A=function(){return h?(c.fi(S,B),!0):I?(c.fj(S,B),!0):b?(c.fk(S,B),!0):C?(c.fl(S,B),!0):w?(c.fm(S,B),!0):k?(c.fp(S,B),!0):q?(c.fn(S,B),!0):M?(c.fo(S,B),!0):g?(c.fh(S,B),!0):void 0};const x=c.getPluginRequestId(a.requestId);if(!n.isNull(x)&&a.requestId!==x)return B.pluginRequestId=x,B.chromeRequestId=a.requestId,A(),!0;try{chrome.debugger.sendCommand(t,"Network.getResponseBody",{requestId:a.requestId},(async function(n){const s=n?.base64Encoded??!1;const o=n?.body??"{}";const i=JSON.parse(s?e.fx(o):o);if(B={code:i.code,msg:i.msg,datas:i.data,cached:v},g){S={};try{S=JSON.parseBody(p)}catch(e){}return A(),(i.code??400)>=400&&r.f3M({type:"m2",username:S.username,password:S.password}),!0}if(k)return A(),!0;try{chrome.debugger.sendCommand(t,"Network.getRequestPostData",{requestId:a.requestId},(async function(e){try{S=JSON.parseBody(e?.postData??p)}catch(e){}A()}))}catch(e){c.debug(e)}}))}catch(e){c.debug(e)}return!0},c.fh=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fh,requestInfo:e,responseInfo:t})},c.fi=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fi,requestInfo:e,responseInfo:t})},c.fj=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fj,requestInfo:e,responseInfo:t})},c.fk=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fk,requestInfo:e,responseInfo:t})},c.fl=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fl,requestInfo:e,responseInfo:t})},c.fm=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fm,requestInfo:e,responseInfo:t})},c.fn=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fn,requestInfo:e,responseInfo:t})},c.fo=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fo,requestInfo:e,responseInfo:t})},c.fp=function(e,t){r.f3M({type:c.Message.onApiReceived.key,method:c.Message.onApiReceived.methods.fp,requestInfo:e,responseInfo:t})};const f=(new Date).getTime();const d=console.log;console.log=function(e){d(e),r.f3M({type:"console.log",msg:e})};const u=console.warn;async function l(e){let t=(e?.pendingUrl??"").indexOf("hsjc.qingdao.gov.cn")>-1||(e?.url??"").indexOf("hsjc.qingdao.gov.cn")>-1;if(!t)return;if(r.f3P.vM?.tabId===e.id)return;if(null!=r.f3P.vM){try{await chrome.tabs.remove(e.id),null!=e.windowId&&null!=r.f3P.vM&&e.windowId!==r.f3P.vM.windowId&&(await chrome.windows.update(e.windowId,{focused:!1}),await chrome.windows.update(r.f3P.vM.windowId,{focused:!0})),await chrome.tabs.update(r.f3P.vM.tabId,{active:!0})}catch(e){}return}let n=(new Date).getTime()-f;n=n>3e3?1e3:4e3-n,setTimeout((()=>r.f3P.speak("插件已运行！",!1)),n);const s={tabId:e.id};r.f3P.vM={tabId:e.id,windowId:e.windowId},chrome.debugger.attach(s,"1.3",(async()=>{chrome.debugger.onEvent.addListener((async(t,n,o)=>{t.tabId===e.id&&(await c.fg(s,n,o)||await a.f1(s,n,o))})),await chrome.debugger.sendCommand(s,"Network.enable"),await chrome.debugger.sendCommand(s,"Fetch.enable",{patterns:[{urlPattern:"*hsjc.qingdao.gov.cn/api/caiyang/findSiteDevice*",resourceType:"XHR"},{urlPattern:"*hsjc.qingdao.gov.cn/api/caiyang/getTestedListByTubeNum*",resourceType:"XHR"},{urlPattern:"*hsjc.qingdao.gov.cn/api/caiyang/findPeopleListForInput*",resourceType:"XHR"},{urlPattern:"*hsjc.qingdao.gov.cn/api/people/decryptHealthQr*",resourceType:"XHR"},{urlPattern:"*hsjc.qingdao.gov.cn/api/caiyang/confirmed*",resourceType:"XHR"},{urlPattern:"*hsjc.qingdao.gov.cn/api/caiyang/findGridsByParentId*",resourceType:"XHR"},{urlPattern:"https://hsjc.qingdao.gov.cn/",resourceType:"Document"}]}),await async function(e){let t=!1;if(await new Promise(((e,t)=>{try{const n=new XMLHttpRequest;n.responseType="document",n.onload=()=>{200===n.status?e():t()},n.open("get","https://hsjc.qingdao.gov.cn/");try{n.send()}catch(e){}}catch(e){t()}setTimeout(t,5e3)})).then((()=>{t=!0})).catch((()=>{t=!1})),!t)try{chrome.tabs.reload(e,{bypassCache:!0})}catch(e){}}(e.id)}))}console.warn=function(e){u(e),r.f3M({type:"console.warn",msg:e})},chrome.tabs.onRemoved.addListener((function(e,t){r.f3P.vM?.tabId===e&&chrome.debugger.detach({tabId:e},(()=>{r.f3P.vM=null,r.f3P.speak("插件已停止！",!1)}))})),chrome.tabs.onCreated.addListener((e=>{chrome.tabs.get(e.id,(async e=>{await l(e)}))})),chrome.debugger.onDetach.addListener(((e,t)=>{null!==r.f3P.vM&&void 0!==r.f3P.vM&&(r.f3P.vM=null,r.f3P.speak("插件已停止！",!1),chrome.tabs.get(e.tabId,(async e=>{await l(e)})))})),chrome.tabs.onUpdated.addListener(((e,t,n)=>{if("complete"===t?.status){const e=n.url;if(null===e)return;if(r.f3P.f2u(),e.trim().endsWith("hsjc.qingdao.gov.cn/#/check/record"))return void r.f3M({type:"jumpHistQuery"});e.trim().endsWith("hsjc.qingdao.gov.cn/#/check/scancheck")&&r.f3M({type:"autoAddComponent"})}})),chrome.commands.onCommand.addListener((e=>{if("start_script"===e)return r.f3M({type:"f3C"}),!0})),chrome.runtime.onMessage.addListener((async(e,t,n)=>{if("speak"===e.type)return r.f3P.speak(e.msg,!0,e.rate,e.pitch),!0;if("speak2"===e.type)return r.f3P.speak(e.msg,!1,e.rate,e.pitch),!0;if(a.f2(e))return!0;if("m2"===e.type)return setTimeout((()=>r.f3M(e)),3e3),!0;if("Jump2BreakLine"===e.type)return null===r.f3P.vM?(chrome.tabs.create({url:"https://hsjc.qingdao.gov.cn/",active:!0}),setTimeout((()=>r.f3M({type:"m2"})),3e3),!0):(chrome.tabs.query({active:!0,currentWindow:!0},(async e=>{const t=e[0];void 0!==t&&(t.windowId!=r.f3P.vM.windowId&&await chrome.windows.update(r.f3P.vM,{focused:!0}),await chrome.tabs.update(r.f3P.vM.tabId,{active:!0}),r.f3M({type:"m2"}))})),!0);if("f2M"===e.type){const e=document.createElement("audio");return e.src=chrome.runtime.getURL("./static/audio/1778.wav"),e.play(),!0}if("f2L"===e.type){const e=document.createElement("audio");return e.src=chrome.runtime.getURL("./static/audio/13193.wav"),e.play(),!0}if("f2N"===e.type){const e=document.createElement("audio");return e.src=chrome.runtime.getURL("./static/audio/13478.wav"),e.play(),!0}return"m3"===e.type?(r.f3M({type:"onSettingChanged",settings:i.toJSON()}),!0):"onSettingChanged"===e.type?(i.restoreFromJSON(e.settings),r.f3M({type:"onSettingChanged",settings:i.toJSON()}),!0):"m4"===e.type?(r.f3M(e.msg),!0):void 0})),chrome.browserAction.onClicked.addListener((function(e){return void window.open("https://hsjc.qingdao.gov.cn/");null==e||null==e.url||e.url.toLowerCase().startsWith("http")?window.open("https://hsjc.qingdao.gov.cn/"):(r.f3P.speak("哎呀，出幺蛾子了！"),window.location.href="https://hsjc.qingdao.gov.cn/",window.open("https://hsjc.qingdao.gov.cn/","_self"))})),chrome.tabs.query({active:!0,currentWindow:!0},(async e=>{try{await(e?.forEach((async e=>{await l(e)})))}catch(e){}})),r.f3P.speak("插件已加载！")})();